{% extends 'Controller/base.html' %}
{% load static %}
{% block content %}
	{% if user.authenticated %}
		<div class="container text-center" style="background-color:#1111; margin-top:1%;" >
			<br>
			<br>
			<br>
			<div class="row">
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">	
			
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(1)">
						    <div class="textH">Node 1</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="1" style="background-color:{{node_grid.1.1}};color:#FFFF" name="1" value= {{node_grid.1.0}} type="submit">
						{{node_grid.1.0}}
					</button>
				
						
				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(2)">
						    <div class="textH">Node 2</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="2" style="background-color:{{node_grid.2.1}};color:#FFFF" name="2" value= {{node_grid.2.0}} type="submit">
						{{node_grid.2.0}}
					</button>
					
				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(3)">
						    <div class="textH">Node 3</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="3"  style="background-color:{{node_grid.3.1}};color:#FFFF" name="3" value= {{node_grid.3.0}} type="submit">
						{{node_grid.3.0}}
					</button>

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(4)">
						    <div class="textH">Node 4</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="4"  style="background-color:{{node_grid.4.1}};color:#FFFF" name="4" value= {{node_grid.4.0}} type="submit">
						{{node_grid.4.0}}
					</button>
				
				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(5)">
						    <div class="textH">Node 5</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="5" style="background-color:{{node_grid.5.1}};color:#FFFF"  name="5" value= {{node_grid.5.0}} type="submit">
						{{node_grid.5.0}}
					</button>
				
				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
				
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(6)">
						    <div class="textH">Node 6</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="6" style="background-color:{{node_grid.6.1}};color:#FFFF" name="6" value= {{node_grid.6.0}} type="submit">
						{{node_grid.6.0}}
					</button>

				</div>
			</div>
			<br>
			<br>
			<br>
			<br>
			<div class="row">
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
			
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(7)">
						    <div class="textH">Node 7</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="7" style="background-color:{{node_grid.7.1}};color:#FFFF"  name="7" value= {{node_grid.7.0}} type="submit">
						{{node_grid.7.0}}
					</button>
				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
				
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(8)">
						    <div class="textH">Node 8</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="8" style="background-color:{{node_grid.8.1}};color:#FFFF"  name="8" value= {{node_grid.8.0}} type="submit">
						{{node_grid.8.0}}
					</button>

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(9)">
						    <div class="textH">Node 9</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="9" style="background-color:{{node_grid.9.1}};color:#FFFF"  name="9" value= {{node_grid.9.0}} type="submit">
						{{node_grid.9.0}}
					</button>
			

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
				
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(10)">
						    <div class="textH">Node 10</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="10" style="background-color:{{node_grid.10.1}};color:#FFFF" name="10" value= {{node_grid.10.0}} type="submit">
						{{node_grid.10.0}}
					</button>

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					
				
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(11)">
						    <div class="textH">Node 11</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="11" style="background-color:{{node_grid.11.1}};color:#FFFF" name="11" value= {{node_grid.11.0}} type="submit">
						{{node_grid.11.0}}
					</button>
				

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(12)">
						    <div class="textH">Node 12</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="12" style="background-color:{{node_grid.12.1}};color:#FFFF" name="12" value= {{node_grid.12.0}} type="submit">
						{{node_grid.12.0}}
					</button>

				</div>
			</div>
			<br>
			<br>
			<br>
			<br>
			<div class="row">
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(13)">
						    <div class="textH">Node 13</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="13" style="background-color:{{node_grid.13.1}};color:#FFFF" name="13" value= {{node_grid.13.0}} type="submit">
						{{node_grid.13.0}}
					</button>

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(14)">
						    <div class="textH">Node 14</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="14" style="background-color:{{node_grid.14.1}};color:#FFFF" name="14" value= {{node_grid.14.0}} type="submit">
						{{node_grid.14.0}}
					</button>
				

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(15)">
						    <div class="textH">Node 15</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="15" style="background-color:{{node_grid.15.1}};color:#FFFF" name="15" value= {{node_grid.15.0}} type="submit">
						{{node_grid.15.0}}
					</button>

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(16)">
						    <div class="textH">Node 16</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="16" style="background-color:{{node_grid.16.1}};color:#FFFF" name="16" value= {{node_grid.16.0}} type="submit">
						{{node_grid.16.0}}
					</button>
				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(17)">
						    <div class="textH">Node 17</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="17" style="background-color:{{node_grid.17.1}};color:#FFFF" name="17" value= {{node_grid.17.0}} type="submit">
						{{node_grid.17.0}}
					</button>
					
				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
				
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(18)">
						    <div class="textH">Node 18</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="18" style="background-color:{{node_grid.18.1}};color:#FFFF" name="18" value= {{node_grid.18.0}} type="submit">
						{{node_grid.18.0}}
					</button>
				
				</div>
			</div>
			<br>
			<br>
			<br>
			<br>
			<div class="row">
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(19)">
						    <div class="textH">Node 19</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="19" style="background-color:{{node_grid.19.1}};color:#FFFF" name="19" value= {{node_grid.19.0}} type="submit">
						{{node_grid.19.0}}
					</button>
					

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(20)">
						    <div class="textH">Node 20</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="20" style="background-color:{{node_grid.20.1}};color:#FFFF"  name="20" value= {{node_grid.20.0}} type="submit">
						{{node_grid.20.0}}
					</button>
					

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(21)">
						    <div class="textH">Node 21</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="21" style="background-color:{{node_grid.21.1}};color:#FFFF" name="21" value= {{node_grid.21.0}} type="submit">
						{{node_grid.21.0}}
					</button>
					
				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(22)">
						    <div class="textH">Node 22</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="22" style="background-color:{{node_grid.22.1}};color:#FFFF" name="22" value= {{node_grid.22.0}} type="submit">
						{{node_grid.22.0}}
					</button>

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(23)">
						    <div class="textH">Node 23</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="23" style="background-color:{{node_grid.23.1}};color:#FFFF"  name="23" value= {{node_grid.23.0}} type="submit">
						{{node_grid.23.0}}
					</button>

				</div>
				<div class="column" style="width:14%;float:left;margin-left: 1%;margin-right: 1%">
					<div class="containerH">
						<img src="{% static 'img/node.png' %}"  width="40%" height="40%" class="imageH" alt="">
						<div class="overlayH" onclick="reset(24)">
						    <div class="textH">Node 24</div>
						 </div>
					</div>
					<br>
					<br>
					<button class="btn" id="24" style="background-color:{{node_grid.24.1}};color:#FFFF"  name="24" value= {{node_grid.24.0}} >
						{{node_grid.24.0}}
					</button>
					

				</div>
				<br>
				<br>
				<br>
			</div>
			<br>
			<br>
			<br>

		</div>
<script>
	var count = 0;
	var nodes = {};
	for(var i = 1;i<25 ;i++){ 
        nodes[i]=document.getElementById(i).value;        
	};

	function isValidForm(){    
      var c = window.confirm("Are you sure you want to turn the node OFF?\n\nPlease make sure that no one is using it before turning it down!");
      if (c != true){
        return false;
      }
    
	    return true;
	}

	function isValidReset(id_button){    
      var c = window.confirm("Are you sure you want to reconnect the node?\n\nPlease make sure that the node is really turned off and it's PoE port is ON!");
      if (c != true){
        return false;
      }
    
	    return true;
	}


	$("button").click(function(){
		var id = $(this).attr('id');
		var value = $(this).attr('value');
		data= { 
			'id': $(this).attr('id'),
			'value' : $(this).attr('value')};
		if(value == "ON"){
			var off = isValidForm();
		}else{
			var off = true;
		}
		
		
			
		if(off == true){
	    	$.post("/config/", data ,function (data) {
	    		if ("error" in data){
	    			confirm(data["error"].toString());
	    		}else{
	    			if(value == "ON"){
	    				console.log("adashdasdhasd")
		            	document.getElementById(id).innerHTML = data[id.toString()][0];
			            document.getElementById(id).value = data[id.toString()][0];
			            document.getElementById(id).style.backgroundColor = data[id.toString()][1];
		            }else{
		            	count+=1;
		            }
	        	}
	        });
	    }	
	

	
		
        


    });
   
   	function reset(id){
   		data= {
   			'id' : id
   		};
   		if( document.getElementById(id).value = "OFF"){
		   	var off = isValidReset();	
		   	if (off == true){
			    $.post("/reset/", data,function (data) {
			    	if (data["code"] == 200){
				        count +=1;
				    }
				    else{
				    	confirm("It was not possible to reconnect node " + id.toString());
				    }
			    });
			}
		}

		
  	}

  	


  	function change_grid(){
	    $.get("/config/", function (data) {
	    	if(!("code" in data)){
	          	for(var i = 1;i<25 ;i++){
		          	if(nodes[i] != data[i.toString()][0]){
		          		count -=1;
			            document.getElementById(i).innerHTML = data[i.toString()][0];
			            document.getElementById(i).value = data[i.toString()][0];
			            document.getElementById(i).style.backgroundColor = data[i.toString()][1];
			            nodes[i] = data[i.toString()][0];

		        	}
	               
	        
	        	};
	       }

	    });

		
  	}


  	function compare() {
  		if(count > 0){
			setInterval(function(){change_grid();},30000);
		}else{
			change_grid();
		}
  	}

  	setInterval(function(){compare();},60000);
  	



    
</script>

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

	{% else %}
	<div class="row" style="margin-bottom: 10%; min-height: 26vh">
	        <!-- Boxes de Acoes -->
			<div class="box">							
				<div class="icon">
					<div class="image"><img class="fa fa-thumbs-o-up"></div>
					<div class="info">
						<div class ="container">
							<h3 class="title">Welcome to the AMazING Switch Controller!</h3>
							<p style="font-size: 120%">Log In to access node grid!</p>
							<a  class="btn btn-primary" href="{% url 'getLogin' %}">Log In</a>
						
						</div>
					</div>
				</div>
			</div>
	</div>
	{% endif %}
	

{% endblock %}
		