<!DOCTYPE HTML>
<!--
	Cube by FreeHTML5.co
	Twitter: http://twitter.com/gettemplateco
	URL: http://freehtml5.co
-->
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="icon" href="images/AMazING_logo.png">
	<title>AMazING</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	

  	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<link href="https://fonts.googleapis.com/css?family=Raleway:100,300,400,700" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Themify Icons-->
	<link rel="stylesheet" href="css/themify-icons.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="css/magnific-popup.css">

	<!-- Owl Carousel  -->
	<link rel="stylesheet" href="css/owl.carousel.min.css">
	<link rel="stylesheet" href="css/owl.theme.default.min.css">

	<!-- Theme style  -->
	<link rel="stylesheet" href="css/style.css">
		
	 
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->

	</head>
	<body>
		
	<div class="gtco-loader"></div>
	
	<div id="page">

		<nav class="gtco-nav" role="navigation" style="position:fixed;height:10%">
			<div class="gtco-container">
				
				<div class="row">
					<div class="col-sm-1 text-left menu-1">
						<div id="gtco-logo"><a href="index.html"><img src="images/AMazING_logo.png" width="100%" alt=""></a></div>
					</div> 
					<div class="col-sm-16 text-right menu-1"  style="width:100%;margin-top: 1%">
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="client.html">Client</a></li>
							<li><a href="scenarios.html">Vision and Scenarios</a></li>
							<li><a href="scenarios.html">Architecture</a></li>
							<li class="has-dropdown">
								<a style="color:#6495ED">Manual</a>
								<ul class="dropdown">
									<li><a href="Manual.html"> Apps Manual</a></li>
									<li><a href="deploy.html">Deployment</a></li>
								</ul>
							</li>
							<li><a href="logbook.html">LogBook</a></li>
							<li><a href="deliverables.html">Deliverables</a></li>
							<li class="active" ><a href="about.html">About</a></li>
						</ul>
					</div>
				</div>
				
			</div>
		</nav>
		<br>
		<br>
		
		



		
		

		<div class="gtco-section gtco-testimonial" >
			<div class="gtco-container"  id= "nav_sec" style= "width:15%;float:left">
				<nav class="md-nav md-nav--secondary" style="position:fixed;">
						<ul class="md-nav__list">
							<li class="md-nav__item">
								<a href="#N" title="Log" class="md-nav__link"style="color:#6495ED">Nodes</a>
							</li>
							<li class="md-nav__item">
								<a href="#RA" title="Log" class="md-nav__link"style="color:#6495ED">Restful API</a>
							</li>
							<li class="md-nav__item">
								<a href="#NC" title="Log" class="md-nav__link"style="color:#6495ED">Node Config App</a>
							</li>
							<li class="md-nav__item">
								<a href="#SW" title="Log" class="md-nav__link" style="color:#6495ED">Switch Controller App</a>
							</li>
							
						</ul>
					
				</nav>
				
							
			</div>
		
			<div class="gtco-container" id = "body_text" style= "width:90%;float:right;margin-top: 1%">
				<div class="row row-pb-sm">
					<div class="col-md-8 col-md-offset-2 gtco-heading" >
						<h2><a id="N" style="position:absolute; margin-top:-15%"></a>Nodes</h2>
						<h4><a style="position:absolute; margin-top:-15%"></a>Overview</h4>
						
						<p style=" text-align: justify;font-size: 110%"> For the nodes we used an <a href="https://www.pcengines.ch/apu2.htm">APU board from PCEngines</a>. </p>
						
						<h4><a style="position:absolute; margin-top:-15%"></a>Preparing OS</h4>
						
						<p style=" text-align: justify;font-size: 110%">For an Operative System we chose Ubuntu Server 18.04 LTS, which is available <a href= http://cdimage.ubuntu.com/releases/18.04.2/release/>here</a>. In case you choose the APU Board from PCEngines
						pick the 64-bit PC (AMD64) server install image, because with the others there is no compability and you have to do incrementals updates from Ubuntu Server 14.04 LTS.</p>
						
						<p style=" text-align: justify;font-size: 110%">After the OS installation is completed you need to install the packages needed by our software to run the Restful API. The script looks like this:</p>
						
						
						<pre><code>
#!/bin/bash

echo 'password' | sudo -S apt-get update -y

echo 'password' | sudo -S apt upgrade -y

echo 'password' | sudo -S apt-get install lm-sensors -y

echo 'password' | sudo -S apt-get install wireless-tools -y

echo 'password' | sudo -S apt-get install hostapd -y

echo 'password' | sudo -S apt-get install wpasupplicant -y

echo 'password' | sudo -S apt-get install dnsmasq -y

echo 'password' | sudo -S apt-get install unzip -y

#Uncomment the next line if you do not have python3 installed, you can check it with python3 --version
#echo 'password' | sudo -S apt-get install python3 -y

##dont_delete is the folder with all the files needed in order to run the software with the boot

echo 'password' | sudo -S mkdir /home/amazing/dont_delete

mkdir /home/amazing/it_user

echo 'password' | sudo -S mv /home/amazing/pei.zip /home/amazing/dont_delete/

##pei.zip was sent to the node via scp (secure copy)

echo 'password' | sudo -S unzip /home/amazing/dont_delete/pei.zip -d /home/amazing/dont_delete/

echo 'password' | sudo -S rm -r /home/amazing/dont_delete/pei.zip

echo 'password' | sudo -S mv /home/amazing/dont_delete/pei/* /home/amazing/dont_delete/

echo 'password' | sudo -S rm -r /home/amazing/dont_delete/pei/

echo 'password' | sudo -S chown root /home/amazing/dont_delete/init_node.sh

echo 'password' | sudo -S chmod 775 /home/amazing/dont_delete/init_node.sh

echo 'password' | sudo -S apt-get install python3-pip -y

echo 'password' | sudo -S pip3 install virtualenv

echo 'password' | sudo -S virtualenv /home/amazing/dont_delete/venv

source /home/amazing/dont_delete/venv/bin/activate

echo 'password' | sudo -S pip3 install -r /home/amazing/dont_delete/requirementsAPI.txt


						</code></pre>
						
						<br>
						<br>
						<p style=" text-align: justify;font-size: 110%">requirementsAPI.txt content:</p>
						<pre><code>
aniso8601==5.1.0
Click==7.0
Flask==1.0.2
Flask-RESTful==0.3.7
itsdangerous==1.1.0
Jinja2==2.10
MarkupSafe==1.1.1
numpy==1.16.2
psutil==5.6.0
pytz==2018.9
relativetimebuilder==0.2.0
six==1.12.0
Werkzeug==0.14.1
						</code></pre>
						

						<br>
						<br>
						
						<p style=" text-align: justify;font-size: 110%">init_node.sh content:</p>
						<pre><code>
#!/bin/bash

source /home/amazing/dont_delete/venv/bin/activate

sudo python3 /home/amazing/dont_delete/APIPEI.py &

sudo python3 /home/amazing/dont_delete/node_init.py &

						</code></pre>
						<br>
						<br>

						<p style=" text-align: justify;font-size: 110%"> Next you need to put the scripts running at boot, so you need to create a crontab as root:</p>


						<pre><code>
$ sudo crontab -e
						</code></pre>

						<br>
						<br>
	
						<p style=" text-align: justify;font-size: 110%"> Choose option 1 and at the end of the file write:</p>
						<pre><code>
@reboot path/to/script/name_of_script.sh
						</code></pre>
						<br>
						<br>
						
						

						<p style=" text-align: justify;font-size: 110%"> Now just need to CTRL+X and then ENTER. At this moment everything you need is installed in the node and running at boot time.</p>
						
					</div>
				</div>
				
				
				
				
			
				<div class="row row-pb-sm">
					<div class="col-md-8 col-md-offset-2 gtco-heading" >
						<h2><a id="RA" style="position:absolute; margin-top:-15%"></a>Restful API</h2>
						<h4><a style="position:absolute; margin-top:-15%"></a>Overview</h4>
						<p style=" text-align: justify;font-size: 110%"> For the node restful API running on nodes and communicating with Node Config App we decided to go with Python with a little help of Flask. We even went further and used a microframework, Flask-Restful. Flask is a powerfull framework that
						in opposition with Django it is better user firendly when no web page is needed.</p>
						
						
						<p style=" text-align: justify;font-size: 110%"> If you have done the previous step correctly you are now able to run a Flask API. </p>
						
					</div>
				</div>
				
				
				<div class="row row-pb-sm">
					<div class="col-md-8 col-md-offset-2 gtco-heading" >

						<h2><a id="SW" style="position:absolute; margin-top:-15%"></a>Node Config App</h2>
						<h4><a style="position:absolute; margin-top:-15%"></a>Overview</h4>
						
						<p style=" text-align: justify;font-size: 110%">Our Node Config App provides an abstraction layer for the end user when perform wireless configurations. We choose Python for building our app backend in addition with Django framework. For the front end html, css, javascript with jquery and ajax was used. </p>
						
						<h4><a style="position:absolute; margin-top:-15%"></a>Preparing environment</h4>
						<pre><code>
$ sudo apt-get update
$ sudo apt-get install python3-pip
$ sudo apt-get install libsasl2-dev python-dev libldap2-dev libssl-dev
$ sudo pip3 install virtualenv
$ sudo virtualenv path/to/virtualenv/name_of_virtualenv
$ source path/to/virtualenv/name_of_virtualenv
$ sudo pip3 install -r requirements.txt
						</code></pre>
						
						<br>
						<br>
						<p><a style="position:absolute; margin-top:-15%"></a>requirements.txt content:</h5>
						<pre><code>
python-ldap==3.2.0
kafka-python==1.4.6
Django==2.2.1
django-auth-ldap==1.7.0
django-background-tasks==1.2.0
django-crispy-forms==1.7.2
djangorestframework==3.9.2
requests==2.21.0
						</code></pre>
						
						
						<p style=" text-align: justify;font-size: 110%"> Right now everything you need to run the Node Config App is installed in the virtual environment.</p>
						
						<p style=" text-align: justify;font-size: 110%">But before you have the app up and running you have to star some services first. First you need to download <a href="https://kafka.apache.org/downloads">Kafka</a>, then if you want you can change files and do your own configurations. Next, to have the service running you have to do 2 commands. Use & at the end of each command if you want to run them both in the same terminal, which means, running in the background, or use 2 terminals.</p>
						
						<pre><code>
sudo path/to/bin/zookeeper-server-start.sh config/zookeeper.properties

sudo path/to/bin/kafka-server-start.sh config/server.properties
						</code></pre>
						
						<br>
						<br>
						
						<p style=" text-align: justify;font-size: 110%"> Next to run the app itself another 2 commands need to be done, 1 to effectively run the app and other to run background_tasks to connect with kafka, and again you can use 2 terminals or just use & at the end of each one.</p>
						
						<pre><code>
sudo pyhton3 path/to/manage.py runserver IP:PORT 

sudo pyhton3 path/to/manage.py process_tasks
						</code></pre>
						
					</div>
				</div>
			
				
				<div class="row row-pb-sm">
					<div class="col-md-8 col-md-offset-2 gtco-heading" >
						<h2><a id="SW" style="position:absolute; margin-top:-15%"></a>Switch Controller App</h2>
						<h4><a style="position:absolute; margin-top:-15%"></a>Overview</h4>
						The Switch Controller App allows the AMazING admin to turn on or off nodes by enabling or disabling the switch PoE ports. 
						Similarly to Node Config App, Python was choosen to build the app backend with the help of Django framework. For the front end html, css, javascript with jquery and ajax was used. </p>
						
						<h4><a style="position:absolute; margin-top:-15%"></a>Preparing environment</h4>
						<pre><code>
$ sudo apt-get update
$ sudo apt-get install python3-pip
$ sudo pip3 install virtualenv
$ sudo virtualenv path/to/virtualenv/name_of_virtualenv
$ source path/to/virtualenv/name_of_virtualenv
$ sudo pip3 install -r requirements.txt
						</code></pre>
						<br>
						<br>
						<p style=" text-align: justify;font-size: 110%">requirements.txt content</p>
						<pre><code>
Django==2.1.7
django-background-tasks==1.2.0
kafka-python==1.4.6
python-dateutil==2.8.0
requests==2.21.0

						</code></pre>
						
						
						<p style=" text-align: justify;font-size: 110%"> Finally everything is installed and you can also run the Switch Controlling App in the virtual environment. 
							To find out how to create a django app please check the <a href="https://docs.djangoproject.com/en/2.2/intro/tutorial01/" >tutorial </a>at the official django web page </p>
						
						<p style=" text-align: justify;font-size: 110%"> To run the app properly and without errors, like the Node Config App you need to have kafka and background-tasks running. </p>
						
					</div>
				</div>
				
				<div class="row row-pb-sm">
					<div class="col-md-8 col-md-offset-2 gtco-heading" >
						<h2><a id="SW" style="position:absolute; margin-top:-15%"></a>Notes</h2>
						
						<p style=" text-align: justify;font-size: 110%"> If you want to have the two web apps running on the same machine you just need to merge the steps above. </p>
						
						<h4><a style="position:absolute; margin-top:-15%"></a>Preparing environment</h4>
						<pre><code>
$ sudo apt-get update
$ sudo apt-get install python3-pip
$ sudo apt-get install libsasl2-dev python-dev libldap2-dev libssl-dev
$ sudo pip3 install virtualenv
$ sudo virtualenv path/to/virtualenv/name_of_virtualenv
$ source path/to/virtualenv/name_of_virtualenv
$ sudo pip3 install -r requirements.txt
						</code></pre>
						<br>
						<br>
						<p style=" text-align: justify;font-size: 110%">requirements.txt content</p>
						<pre><code>
Django==2.2.1
django-auth-ldap==1.7.0
django-background-tasks==1.2.0
django-crispy-forms==1.7.2
djangorestframework==3.9.2
kafka-python==1.4.6
python-dateutil==2.8.0
python-ldap==3.2.0
requests==2.21.0
						</code></pre>
						
						<br>
						<br>
						
						<p style=" text-align: justify;font-size: 110%">Since you need to run several things it is better to create a script and use crontab again to make it run at boot.</p>
						
						
						<pre><code>
#!/bin/bash

source path/to/virtualenv/name_of_virtualenv

sudo path/to/bin/zookeeper-server-start.sh config/zookeeper.properties & 

sudo path/to/bin/kafka-server-start.sh config/server.properties &

sudo python3 /path/to/1stApp/manage.py runserver IP:PORT &

sudo python3 /path/to/1stApp/manage.py process_tasks &

sudo python3 /path/to/2stApp/manage.py runserver IP:PORT & 

sudo python3 /path/to/2stApp/manage.py runserver process_tasks &
						</code></pre>
					</div>
				</div>
				
				<div class="row row-pb-sm">
					<div class="col-md-8 col-md-offset-2 gtco-heading" >
						<h2><a id="SW" style="position:absolute; margin-top:-15%"></a><a href =""> <img src = "images/github_icon.png" > GitHub Repository</a></h2>
						
						
						
						 
				</div>
				
				
				
				
			</div>	

				
		</div>

		<footer id="gtco-footer" class="gtco-section" role="contentinfo">
			<div class="gtco-container">
				<div class="row">
					<div class="col-md-12 text-right">
						<ul class="gtco-social-icons pull-right">
							<li><a href="https://www.ua.pt" target="_blank"><img  src="images/logo_UA.png" alt=""  width="12%" height="12%"></a></li>
						</ul>
					
					</div>
					<div class="col-md-12 text-left">
						<p><small>&copy; PEI - AMazING 2019 </small></p>
					</div>
					
				</div>
			</div>
				
			
		</footer>

	

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
	</div>
	
	<script>
		var width = (window.innerWidth > 0) ? window.innerWidth : screen.width;
		if(width < 600){
			document.getElementById("nav_sec").remove();
			document.getElementById("body_text").style.width = "100%";
			document.getElementById("body_text").style.ccFloat = "none";
			
		}
	</script>
	
	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Carousel -->
	<script src="js/owl.carousel.min.js"></script>
	<!-- Magnific Popup -->
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/magnific-popup-options.js"></script>
	<!-- Main -->
	<script src="js/main.js"></script>

	</body>
</html>

